(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84236,       2469]
NotebookOptionsPosition[     74063,       2103]
NotebookOutlinePosition[     74425,       2119]
CellTagsIndexPosition[     74382,       2116]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
PHSX 565 Astrophysical Plasma Physics
Problem Set 2 - Planetary Atmosphere with Greenhouse Effect
Roy Smart\
\>", "Chapter",
 CellChangeTimes->{{3.714258283832344*^9, 3.714258346126742*^9}}],

Cell[CellGroupData[{

Cell["Preparing the Mathematica environment...", "Subsection",
 CellChangeTimes->{{3.713221733544059*^9, 3.713221749021214*^9}}],

Cell[CellGroupData[{

Cell["Clear Mathematica environment", "Subsubsection",
 CellChangeTimes->{{3.713222930931643*^9, 3.71322294554322*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7132229470758877`*^9, 3.713222955978175*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Declare Assumptions", "Subsubsection",
 CellChangeTimes->{{3.714265417347416*^9, 3.714265422494422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", " ", "=", " ", 
   RowBox[{
    RowBox[{"cs", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"g", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"ztp", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"\[Sigma]ir", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"m", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"\[Rho]", "[", "z", "]"}], " ", ">", " ", "0"}], " ", "&&", " ", 
    
    RowBox[{"kB", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"\[CapitalGamma]", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"ptr", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"Teff", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"p", " ", ">", " ", "ptr"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714265425437289*^9, 3.714265430138419*^9}, {
   3.714338909924642*^9, 3.714338915136698*^9}, {3.714345006349491*^9, 
   3.714345009842401*^9}, {3.714345411343638*^9, 3.7143454569891*^9}, {
   3.714359961563953*^9, 3.714359968049713*^9}, {3.714434074408866*^9, 
   3.7144341019446287`*^9}, 3.714434741901085*^9, {3.7144361208988943`*^9, 
   3.7144361233747463`*^9}, {3.714436240537726*^9, 3.714436244261467*^9}, {
   3.7144365376112823`*^9, 3.71443654390727*^9}, {3.714436648610011*^9, 
   3.714436653612092*^9}, {3.714436684566186*^9, 3.71443668530803*^9}, 
   3.714436717847776*^9, 3.714437629486765*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define shortcut to convert rule to equation", "Subsubsection",
 CellChangeTimes->{{3.7144347504965076`*^9, 3.714434759733533*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r2e", " ", "=", " ", 
   RowBox[{"Rule", " ", "\[Rule]", " ", "Equal"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714428673697979*^9, 3.714428685703141*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Provide numerical values for constants", "Subsubsection",
 CellChangeTimes->{{3.714349653609832*^9, 3.714349662261554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kB", "\[Rule]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"UnitConvert", "[", 
        RowBox[{"Quantity", "[", "\"\<Boltzmann Constant\>\"", "]"}], "]"}], "/.", 
       RowBox[{"\"\<Kelvins\>\"", "\[Rule]", "\"\<KelvinsDifference\>\""}]}], 
      ")"}]}], ",", 
    RowBox[{"g", "\[Rule]", " ", 
     TemplateBox[{
      "1",StyleBox["\"g\"", Italic, StripOnInput -> False],
       "standard accelerations due to gravity on the surface of the earth",
       "\"StandardAccelerationOfGravity\""},
      "Quantity"]}], ",", 
    RowBox[{"\[Sigma]SB", "\[Rule]", " ", 
     TemplateBox[{
      InterpretationBox["\[InvisibleSpace]", 1],"\"\[Sigma]\"",
       "Stefan\[Hyphen]Boltzmann constants","\"StefanBoltzmannConstant\""},
      "Quantity"]}], ",", 
    RowBox[{"m", "\[Rule]", " ", 
     RowBox[{
      TemplateBox[{"\"dry air\"",RowBox[{"Entity", "[", 
          RowBox[{"\"Chemical\"", ",", "\"DryAir\""}], "]"}],
        "\"Entity[\\\"Chemical\\\", \\\"DryAir\\\"]\"","\"chemical\""},
       "Entity"], "[", 
      TemplateBox[{"\"molecular mass\"",RowBox[{"EntityProperty", "[", 
          RowBox[{"\"Chemical\"", ",", "\"MolecularMass\""}], "]"}],
        "\"EntityProperty[\\\"Chemical\\\", \\\"MolecularMass\\\"]\""},
       "EntityProperty"], "]"}]}], ",", " ", 
    RowBox[{"Teff\[Earth]", "\[Rule]", " ", 
     RowBox[{"240", 
      TemplateBox[{
       InterpretationBox["\[InvisibleSpace]", 1],"\"K\"","kelvins difference",
        "\"KelvinsDifference\""},
       "Quantity"]}]}], ",", 
    RowBox[{"\[Alpha]\[Earth]", "\[Rule]", " ", "0.45"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.71434967727079*^9, 3.714349721296751*^9}, {
   3.714349807707375*^9, 3.714349820778068*^9}, {3.71434995489995*^9, 
   3.714349978295972*^9}, {3.714350018273786*^9, 3.714350020518108*^9}, 
   3.714350152492312*^9, 3.714350623968001*^9, {3.714351841071042*^9, 
   3.7143519443208513`*^9}, {3.714352933901922*^9, 3.714352964605847*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kB", "\[Rule]", 
    TemplateBox[{
     "1.38064852`5.941426044735842*^-23",RowBox[{"\"kg\"", "\[ThinSpace]", 
        SuperscriptBox["\"m\"", "2"], "\[NegativeMediumSpace]", "\"/(\"", 
        "\[InvisibleSpace]", 
        SuperscriptBox["\"s\"", "2"], "\[InvisibleSpace]", "\"K\"", 
        "\[InvisibleSpace]", "\")\""}],
      "kilogram meters squared per second squared kelvin difference",
      FractionBox[
       RowBox[{"\"Kilograms\"", " ", 
         SuperscriptBox["\"Meters\"", "2"]}], 
       RowBox[{"\"KelvinsDifference\"", " ", 
         SuperscriptBox["\"Seconds\"", "2"]}]]},
     "Quantity"]}], ",", 
   RowBox[{"g", "\[Rule]", 
    TemplateBox[{
     "1",StyleBox["\"g\"", Italic, StripOnInput -> False],
      "standard accelerations due to gravity on the surface of the earth",
      "\"StandardAccelerationOfGravity\""},
     "Quantity"]}], ",", 
   RowBox[{"\[Sigma]SB", "\[Rule]", 
    TemplateBox[{
     "1","\"\[Sigma]\"","Stefan\[Hyphen]Boltzmann constants",
      "\"StefanBoltzmannConstant\""},
     "Quantity"]}], ",", 
   RowBox[{"m", "\[Rule]", 
    TemplateBox[{
     "28.96`","\"u\"","unified atomic mass units","\"AtomicMassUnit\""},
     "Quantity"]}], ",", 
   RowBox[{"Teff\[Earth]", "\[Rule]", 
    TemplateBox[{"240","\"K\"","kelvins difference","\"KelvinsDifference\""},
     "Quantity"]}], ",", 
   RowBox[{"\[Alpha]\[Earth]", "\[Rule]", "0.45`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.714350170558346*^9, 3.714350474628889*^9, 3.714350624249099*^9, 
   3.714352103796212*^9, {3.714352935149151*^9, 3.714352968388616*^9}, 
   3.7143592317592583`*^9, 3.7143595368838663`*^9, 3.714359972976841*^9, 
   3.7144200983861*^9, 3.7144289443556213`*^9, 3.714429027521277*^9, 
   3.714430169492844*^9, 3.714431475794668*^9, 3.7144332687778997`*^9, 
   3.714433481738371*^9, 3.7144335346884413`*^9, 3.714433601994672*^9, 
   3.714434082843943*^9, 3.7144341197043877`*^9, 3.714436126547707*^9, 
   3.7144362505506496`*^9, 3.714436547005663*^9, {3.7144366583605537`*^9, 
   3.7144366879081497`*^9}, 3.714436721168116*^9, 3.714437377389084*^9, {
   3.714437605897616*^9, 3.714437632262663*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We are provide the following information in the problem statement\
\>", "Subsection",
 CellChangeTimes->{{3.714258658051032*^9, 3.714258682626346*^9}}],

Cell[CellGroupData[{

Cell["The energy flux heating the planetary surface is", "Subsubsection",
 CellChangeTimes->{{3.714258994003613*^9, 3.714259035217882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"F0I$", " ", "=", " ", 
   RowBox[{"F0", " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], "F\[EmptyCircle]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714258734565926*^9, 3.714258764098197*^9}, {
   3.7142588326484537`*^9, 3.714258842022238*^9}, {3.71425887297891*^9, 
   3.71425888916*^9}, 3.71425908797556*^9, {3.714259167749279*^9, 
   3.714259169082033*^9}, 3.7143419244072523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The energy flux emitted by the planet is", "Subsubsection",
 CellChangeTimes->{{3.714259050715983*^9, 3.714259059963015*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"F0E$", " ", "=", " ", 
   RowBox[{"F0", " ", "\[Rule]", " ", 
    RowBox[{"\[Sigma]SB", " ", 
     SuperscriptBox["Teff", "4"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714259090534875*^9, 3.714259113853862*^9}, {
   3.714259171603182*^9, 3.714259172836337*^9}, 3.714341930697212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The mean free path of an infared photon is", "Subsubsection",
 CellChangeTimes->{{3.714259180780074*^9, 3.714259188444068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lmfp$", "[", "z_", "]"}], " ", ":=", " ", 
  RowBox[{"lmfp", " ", "\[Rule]", " ", 
   FractionBox["m", 
    RowBox[{
     RowBox[{"\[Rho]", "[", "z", "]"}], "\[Sigma]ir"}]]}]}]], "Input",
 CellChangeTimes->{{3.714259190283519*^9, 3.7142592432018642`*^9}, {
  3.714341656514193*^9, 3.7143416989159822`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The optically thick troposphere has a radiative conductivity given by \
(Longcope 1.46)\
\>", "Subsubsection",
 CellChangeTimes->{{3.7143466453321953`*^9, 3.7143466932227287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Kappa]rad$", " ", "=", " ", 
   RowBox[{"\[Kappa]rad", " ", "\[Rule]", " ", 
    RowBox[{"8", " ", "\[Sigma]SB", " ", 
     SuperscriptBox["T", "3"], " ", "lmfp"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714346696842428*^9, 3.714346755985855*^9}, {
  3.714433344566868*^9, 3.714433357060693*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The tropopause has the temperature", "Subsubsection",
 CellChangeTimes->{{3.714259416083765*^9, 3.714259434783883*^9}, {
  3.714429928275876*^9, 3.7144299330171967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tztp$", " ", "=", " ", 
   RowBox[{
    RowBox[{"T", "[", "ztp", "]"}], "\[Rule]", " ", "Teff"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7142594422892513`*^9, 3.7142595750645733`*^9}, {
  3.71425997533246*^9, 3.714259976359354*^9}, {3.714429908929537*^9, 
  3.714429935433586*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Useful definitions given in the notes", "Subsection",
 CellChangeTimes->{{3.714350592916728*^9, 3.714350611060128*^9}}],

Cell[CellGroupData[{

Cell["Isothermal sound speed", "Subsubsection",
 CellChangeTimes->{{3.714359063210825*^9, 3.714359066543969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs$", " ", "=", " ", 
   RowBox[{"cs", " ", "\[Rule]", " ", 
    SqrtBox[
     RowBox[{"kB", " ", 
      RowBox[{"T0", " ", "/", " ", "m"}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7143506146368113`*^9, 3.7143506553128843`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ideal gas law", "Subsubsection",
 CellChangeTimes->{{3.714359074657902*^9, 3.714359077064212*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p$", "[", "z_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"p", "[", "z", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["kB", "m"], 
     RowBox[{"\[Rho]", "[", "z", "]"}], " ", 
     RowBox[{"T", "[", "z", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7143590798484488`*^9, 3.714359138107067*^9}, {
  3.714359219769641*^9, 3.714359222462008*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polytropic density relationship", "Subsubsection",
 CellChangeTimes->{{3.7143597673787622`*^9, 3.714359779097*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]$", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "z", "]"}], "\[Rule]", " ", 
    RowBox[{"K0", " ", 
     SuperscriptBox[
      RowBox[{"p", "[", "z", "]"}], 
      RowBox[{"1", "/", "\[CapitalGamma]"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71435978218648*^9, 3.714359834115518*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part a.", "Section",
 CellChangeTimes->{{3.7142595861201687`*^9, 3.714259587298078*^9}}],

Cell[CellGroupData[{

Cell["\<\
The optical depth one condition is given in the problem statement as\
\>", "Subsection",
 CellChangeTimes->{{3.7142597656450777`*^9, 3.714259774040331*^9}, {
  3.714341988581867*^9, 3.71434199195542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"od1$a", " ", "=", " ", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "ztp", "\[Infinity]"], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "z"}], 
      RowBox[{"lmfp", "[", "z", "]"}]]}], " ", "\[Equal]", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "ztp", "\[Infinity]"], 
     RowBox[{"\[Sigma]ir", 
      FractionBox[
       RowBox[{"\[Rho]", "[", "z", "]"}], "m"], 
      RowBox[{"\[DifferentialD]", "z"}]}]}], " ", "\[Equal]", " ", "1"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714259817603299*^9, 3.71425994636865*^9}, 
   3.7142599862136097`*^9, {3.714339224002763*^9, 3.7143392258464603`*^9}, 
   3.714339283988068*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the pressure at the tropopause", "Subsection",
 CellChangeTimes->{{3.714260336435107*^9, 3.7142603458176327`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Since the stratosphere is isothermal, we can use the exponential hydrostatic \
density, where the reference point is at the tropopause (Longcope 2.13)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714260719085545*^9, 3.71426072976542*^9}, {
  3.7142608046870527`*^9, 3.714260824430085*^9}, {3.714264816343553*^9, 
  3.7142648745790567`*^9}, {3.714265067185678*^9, 3.714265067596828*^9}, {
  3.714341883206558*^9, 3.714341914963745*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]hs$", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]", "[", "z", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"\[Rho]", "[", "z0", "]"}], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"z", "-", "z0"}], ")"}]}], 
        RowBox[{"g", "/", 
         SuperscriptBox["cs", "2"]}]}]]}]}], " ", "/.", " ", 
    RowBox[{"z0", "\[Rule]", " ", "ztp"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7142608356780977`*^9, 3.714260888550193*^9}, {
   3.714264637725651*^9, 3.7142646531798563`*^9}, {3.714264713996378*^9, 
   3.714264742816534*^9}, {3.71426479431107*^9, 3.7142648099737997`*^9}, {
   3.714265124208582*^9, 3.7142651303483887`*^9}, 3.714339062487822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
and the linear relationship between density and pressure (Longcope 2.5)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714265151278277*^9, 3.714265170139298*^9}, {
  3.714265241240869*^9, 3.7142652551400843`*^9}, {3.714341960292975*^9, 
  3.714341979063344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]it$", "[", "z_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"\[Rho]", "[", "z", "]"}], " ", "\[Rule]", " ", 
    FractionBox[
     RowBox[{"p", "[", "z", "]"}], 
     SuperscriptBox["cs", "2"]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7142651865301123`*^9, 3.7142652370311117`*^9}, {
   3.714265373521235*^9, 3.714265377952071*^9}, 3.714339071318812*^9, {
   3.714339116117029*^9, 3.7143391216997633`*^9}, {3.7143393437872553`*^9, 
   3.714339345150297*^9}, {3.714339437919924*^9, 3.714339466699875*^9}, 
   3.71433949873629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
in the right-hand equality in the optical depth one condition and solve for \
p[ztp]\
\>", "Subsubsection",
 CellChangeTimes->{{3.714261185121821*^9, 3.7142612133300667`*^9}, {
  3.71426488151604*^9, 3.714264882854227*^9}, {3.714265260934153*^9, 
  3.714265284235332*^9}, {3.714339093000533*^9, 3.7143390952963743`*^9}, {
  3.714339491082849*^9, 3.7143394934886627`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"pztp$a", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"od1$a", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", " ", 
          RowBox[{"od1$a", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "/.", " ", "\[Rho]hs$"}], "/.", 
        RowBox[{"\[Rho]it$", "[", "ztp", "]"}]}], ",", " ", 
       RowBox[{"p", "[", "ztp", "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], " ", "//", 
  "Framed"}]], "Input",
 CellChangeTimes->{{3.714260906154222*^9, 3.71426090863902*^9}, {
  3.71426393627569*^9, 3.714263945658025*^9}, {3.71426437306306*^9, 
  3.7142643915322943`*^9}, {3.7143390576606703`*^9, 3.714339083843513*^9}, {
  3.714339137574119*^9, 3.714339141633985*^9}, {3.714339195699181*^9, 
  3.714339216349926*^9}, {3.7143392548771772`*^9, 3.7143392882578917`*^9}, {
  3.714339337326065*^9, 3.714339533430346*^9}, {3.714339571717767*^9, 
  3.714339573607518*^9}, {3.7143405371464987`*^9, 3.714340541977022*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{"p", "[", "ztp", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{"g", " ", "m"}], "\[Sigma]ir"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.7142609032143106`*^9, 3.714260908882716*^9}, {
   3.7142643763193207`*^9, 3.714264392486052*^9}, 3.714264656691182*^9, 
   3.7142647594585743`*^9, {3.714265392715658*^9, 3.714265397716302*^9}, 
   3.714338919346423*^9, {3.714339067124887*^9, 3.7143391039108*^9}, {
   3.714339210405003*^9, 3.71433929284231*^9}, {3.714339377693326*^9, 
   3.71433952493156*^9}, {3.714339567269824*^9, 3.714339574391245*^9}, 
   3.7143406265786858`*^9, 3.714341703060863*^9, 3.714345429554743*^9, 
   3.714345460216284*^9, 3.714350171150901*^9, 3.714350475143214*^9, 
   3.714352104317831*^9, {3.7143529418984222`*^9, 3.714352969610935*^9}, 
   3.714359232299934*^9, 3.714359537421069*^9, 3.7143599737606583`*^9, 
   3.714420099458571*^9, 3.7144289449941053`*^9, 3.714429028178647*^9, 
   3.714430170161256*^9, 3.714431476508931*^9, 3.714433269622604*^9, 
   3.714433482424679*^9, 3.7144335353414717`*^9, 3.714433604135655*^9, 
   3.714434083744186*^9, 3.7144341205879793`*^9, 3.7144361273687143`*^9, 
   3.714436251479637*^9, 3.714436547929364*^9, {3.714436659525278*^9, 
   3.7144366891760483`*^9}, 3.7144367220162153`*^9, 3.714437378568445*^9, {
   3.71443760656733*^9, 3.714437633300254*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part b.", "Section",
 CellChangeTimes->{{3.7143390403683043`*^9, 3.714339050578352*^9}, {
  3.714340531852633*^9, 3.714340533828169*^9}}],

Cell[CellGroupData[{

Cell["\<\
Show that the photon mean free path matches the pressure scale height\
\>", "Subsection",
 CellChangeTimes->{{3.714340780082426*^9, 3.7143408185157413`*^9}, {
  3.714341416032078*^9, 3.714341422307152*^9}}],

Cell[CellGroupData[{

Cell["\<\
Evaluate the photon mean free path using the definition and the answer from \
Part a.\
\>", "Subsubsection",
 CellChangeTimes->{{3.714341626335121*^9, 3.714341633853953*^9}, {
  3.714341789349609*^9, 3.714341822930814*^9}, {3.7143457953672247`*^9, 
  3.7143457957730417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"lmfp$b", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"lmfp$", "[", "ztp", "]"}], " ", "/.", " ", 
      RowBox[{"\[Rho]it$", "[", "ztp", "]"}]}], " ", "/.", " ", "pztp$a"}]}], 
   ")"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.7143417066204023`*^9, 3.714341708183984*^9}, {
  3.7143417709857063`*^9, 3.714341781500589*^9}, {3.7143418334623623`*^9, 
  3.714341870491147*^9}, {3.714345604185278*^9, 3.714345607628147*^9}, {
  3.714350468141181*^9, 3.714350471779916*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"lmfp", "\[Rule]", 
   FractionBox[
    SuperscriptBox["cs", "2"], "g"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.714341853990445*^9, 3.7143418707148027`*^9}, 
   3.714345429699439*^9, 3.714345460358265*^9, 3.7143456081361113`*^9, 
   3.714350171291616*^9, {3.714350472191771*^9, 3.714350475311309*^9}, 
   3.7143521044257803`*^9, {3.714352942060109*^9, 3.714352969854086*^9}, 
   3.714359232412758*^9, 3.7143595375068913`*^9, 3.714359973899283*^9, 
   3.7144200996740932`*^9, 3.714428945198934*^9, 3.7144290283717527`*^9, 
   3.714430170346298*^9, 3.714431476688233*^9, 3.7144332698191843`*^9, 
   3.7144334826427298`*^9, 3.7144335355594063`*^9, 3.71443360446771*^9, 
   3.714434084020524*^9, 3.714434120813558*^9, 3.7144361276220627`*^9, 
   3.7144362516898327`*^9, 3.714436548220347*^9, {3.7144366597533693`*^9, 
   3.714436689391478*^9}, 3.714436722301607*^9, 3.7144373788412333`*^9, {
   3.714437606723288*^9, 3.7144376335209217`*^9}}]
}, Open  ]]
}, Open  ]],

Cell["\<\
which is the same as the definition of the scale height (Longcope paragraph \
below 2.13)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714342003452518*^9, 3.7143420452537737`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Show that the mean free path is less than the scale height throughout the \
troposphere\
\>", "Subsection",
 CellChangeTimes->{{3.7143449458124237`*^9, 3.7143449692988167`*^9}}],

Cell[CellGroupData[{

Cell["\<\
The pressure scale height can also be expressed as (Longcope paragraph below \
2.13)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714345122043983*^9, 3.7143451430591097`*^9}, {
  3.71434522915275*^9, 3.714345230129776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Hp$", " ", "=", " ", 
   RowBox[{"Hp", "\[Rule]", " ", 
    FractionBox[
     RowBox[{"p", "[", "z", "]"}], 
     RowBox[{
      RowBox[{"\[Rho]", "[", "z", "]"}], " ", "g"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7143452176945*^9, 3.714345259050383*^9}, {
  3.714345369021284*^9, 3.7143453718733664`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plug into the inequality", "Subsubsection",
 CellChangeTimes->{{3.7143452848322678`*^9, 3.71434528841121*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ineq$b", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"lmfp", " ", "<", " ", "Hp"}], " ", "/.", " ", 
     RowBox[{"lmfp$", "[", "z", "]"}]}], " ", "/.", " ", "Hp$"}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.714345290902409*^9, 3.714345354836932*^9}, {
  3.714345393570483*^9, 3.714345406126132*^9}, {3.7143455554117002`*^9, 
  3.714345599168014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "m"}], "<", 
  RowBox[{"\[Sigma]ir", " ", 
   RowBox[{"p", "[", "z", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.7143453125988817`*^9, {3.7143453554023657`*^9, 3.714345429837414*^9}, 
   3.714345460491678*^9, {3.7143455572571487`*^9, 3.7143456156775312`*^9}, 
   3.714350171448852*^9, 3.714350475419372*^9, 3.714352104541169*^9, {
   3.714352942298709*^9, 3.7143529701006117`*^9}, 3.714359232529635*^9, 
   3.714359537608107*^9, 3.714359974131125*^9, 3.714420099927153*^9, 
   3.714428945579685*^9, 3.714429028542351*^9, 3.714430170529436*^9, 
   3.7144314768663187`*^9, 3.714433270015822*^9, 3.714433482840527*^9, 
   3.71443353585541*^9, 3.714433604830574*^9, 3.7144340842841787`*^9, 
   3.7144341210561028`*^9, 3.71443612792027*^9, 3.714436251996565*^9, 
   3.714436548503677*^9, {3.714436660046455*^9, 3.714436689653878*^9}, 
   3.714436722538886*^9, 3.714437379103647*^9, {3.714437606937685*^9, 
   3.714437633745379*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Logically reduce the solution using the condition found in Part a.\
\>", "Subsubsection",
 CellChangeTimes->{{3.714345756943861*^9, 3.714345792109015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Reduce", "[", 
      RowBox[{"{", 
       RowBox[{"ineq$b", ",", " ", 
        RowBox[{"pztp$a", "/.", " ", 
         RowBox[{"Rule", " ", "\[Rule]", " ", "Equal"}]}]}], "}"}], "]"}], 
     " ", "//", "FullSimplify"}], ")"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.71434568546404*^9, 3.7143457240801373`*^9}, {
  3.71434581169803*^9, 3.714345813224461*^9}, {3.714434795084765*^9, 
  3.714434811679223*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{"p", "[", "z", "]"}], ">", 
   RowBox[{"p", "[", "ztp", "]"}]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.7143457174325*^9, 3.7143457243976803`*^9}, 
   3.714345813531599*^9, 3.714350171539632*^9, 3.714350475579851*^9, 
   3.7143521046483192`*^9, {3.714352942491268*^9, 3.7143529704363413`*^9}, 
   3.714359232679543*^9, 3.714359537708057*^9, 3.714359974360057*^9, 
   3.714420100199391*^9, 3.714428945764217*^9, 3.7144290287171717`*^9, 
   3.714430170699082*^9, 3.714431477040083*^9, 3.714433270277713*^9, 
   3.714433483033864*^9, 3.714433536046036*^9, 3.714433605097406*^9, 
   3.714434084592094*^9, 3.714434121322043*^9, {3.7144347965666313`*^9, 
   3.714434812353815*^9}, 3.714436128210396*^9, 3.714436252262754*^9, 
   3.714436548772319*^9, {3.714436660335658*^9, 3.71443668994842*^9}, 
   3.714436722860573*^9, 3.7144373793563004`*^9, {3.714437607128192*^9, 
   3.714437634032683*^9}}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Apparently, as long as the pressure is greater in the troposphere than it is \
at the tropopause (as it should be) the mean free path is less than the scale \
height throughout the troposphere\
\>", "Subsubsection",
 CellChangeTimes->{{3.7143458166482143`*^9, 3.7143458919161386`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part c.", "Section",
 CellChangeTimes->{{3.714345905272057*^9, 3.714345906911025*^9}}],

Cell[CellGroupData[{

Cell["\<\
Find the value of the polytropic index \[CapitalGamma] by assuming the entire \
troposphere has the same radiative conductivity as the tropopause\
\>", "Subsection",
 CellChangeTimes->{{3.714346163246758*^9, 3.7143462201583433`*^9}}],

Cell[CellGroupData[{

Cell["\<\
The polytropic exponent can be found using the expression (Longcope 2.23)\
\>", "Subsubsection",
 CellChangeTimes->{{3.71434684800806*^9, 3.714346875118272*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]$", " ", "=", " ", 
   RowBox[{"\[CapitalGamma]", "\[Rule]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", " ", "-", " ", 
       FractionBox[
        RowBox[{"kB", " ", "F"}], 
        RowBox[{"m", " ", "g", " ", "\[Kappa]"}]]}], ")"}], 
     RowBox[{"-", "1"}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7143469151843967`*^9, 3.714346978267564*^9}, {
  3.714352099656383*^9, 3.714352100868456*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plugging in the heat flux emitted by the planet, the radiative thermal \
conductivity at the tropopause, the mean free path at the tropopause, and the \
definition of the isothermal sound speed gives\
\>", "Subsubsection",
 CellChangeTimes->{{3.714349384990231*^9, 3.714349420239977*^9}, {
  3.71434954971336*^9, 3.714349554033869*^9}, {3.714350224851103*^9, 
  3.714350226741744*^9}, {3.714350676398683*^9, 3.714350697189433*^9}, {
  3.714432745728459*^9, 3.7144327665986156`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[CapitalGamma]$c", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalGamma]$", " ", "/.", " ", 
            RowBox[{"F", "\[Rule]", " ", "F0"}]}], " ", "/.", " ", "F0E$"}], "/.",
           " ", 
          RowBox[{"\[Kappa]", "\[Rule]", "\[Kappa]rad"}]}], " ", "/.", 
         "\[Kappa]rad$"}], " ", "/.", " ", 
        RowBox[{"T", "\[Rule]", " ", "Teff"}]}], " ", "/.", " ", "lmfp$b"}], 
      " ", "/.", " ", "cs$"}], "/.", " ", 
     RowBox[{"T0", "\[Rule]", " ", "Teff"}]}]}], ")"}], " ", "//", 
  "Framed"}]], "Input",
 CellChangeTimes->{{3.7143494258852654`*^9, 3.714349460354961*^9}, {
   3.7143495135571327`*^9, 3.714349517777849*^9}, {3.7143496230157747`*^9, 
   3.714349639361516*^9}, {3.714350229685563*^9, 3.7143502389629297`*^9}, {
   3.714350700092956*^9, 3.714350732765152*^9}, 3.714351212710408*^9}],

Cell[BoxData[
 FrameBox[
  RowBox[{"\[CapitalGamma]", "\[Rule]", 
   FractionBox["8", "7"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.714349461265542*^9, 3.714349466190147*^9}, 
   3.714349518065042*^9, {3.714349629844212*^9, 3.7143496396204653`*^9}, 
   3.7143501716339703`*^9, {3.714350235719955*^9, 3.7143502398216457`*^9}, 
   3.714350475671464*^9, {3.714350706259644*^9, 3.714350733012467*^9}, 
   3.714351214154519*^9, 3.7143521047847643`*^9, {3.7143529428500767`*^9, 
   3.714352970739787*^9}, 3.714359232805841*^9, 3.714359537831551*^9, 
   3.7143599745114117`*^9, 3.714420100362376*^9, 3.714428946030367*^9, 
   3.714429028986021*^9, 3.714430170954105*^9, 3.714431477319433*^9, 
   3.7144332705539093`*^9, 3.714433483225472*^9, 3.7144335362432117`*^9, 
   3.7144336054726343`*^9, 3.714434084789562*^9, 3.714434121585216*^9, 
   3.714436128501852*^9, 3.714436252553586*^9, 3.714436549043363*^9, {
   3.71443666061726*^9, 3.7144366901718407`*^9}, 3.714436723121509*^9, 
   3.714437379638721*^9, {3.7144376073212433`*^9, 3.714437634286642*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check if the condition \[CapitalGamma] > \[Gamma] is satisfied", \
"Subsection",
 CellChangeTimes->{{3.714350897452414*^9, 3.714350917947744*^9}}],

Cell[CellGroupData[{

Cell["\<\
For an ideal gas, the ratio of specific heats is given as a function of the \
number of degrees of freedom, f\
\>", "Subsubsection",
 CellChangeTimes->{{3.714350922107573*^9, 3.714351013483589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]$", " ", "=", 
   RowBox[{"\[Gamma]", "\[Rule]", "  ", 
    RowBox[{"1", " ", "+", " ", 
     FractionBox["2", "f"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7143509436995993`*^9, 3.714350956111701*^9}, {
  3.714351225281536*^9, 3.714351227506384*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The number of degrees of freedom must be greater than one", \
"Subsubsection",
 CellChangeTimes->{{3.71435100212786*^9, 3.714351025006394*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", " ", "=", " ", 
   RowBox[{"$Assumptions", " ", "&&", " ", 
    RowBox[{"f", " ", ">", " ", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714351027729746*^9, 3.714351047667457*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["We now have enough information to check the condition", "Subsubsection",
 CellChangeTimes->{{3.714351180728257*^9, 3.7143511933990717`*^9}, {
  3.714352245113353*^9, 3.714352265045394*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]", " ", ">", " ", "\[Gamma]"}], " ", "/.", " ", 
     "\[CapitalGamma]$c"}], " ", "/.", " ", "\[Gamma]$"}], " ", "//", 
   "Simplify"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.714351200680805*^9, 3.7143512454825478`*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"f", ">", "14"}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.7143512214394913`*^9, 3.7143512457085543`*^9}, 
   3.7143521049074917`*^9, {3.714352943196405*^9, 3.714352971175565*^9}, 
   3.7143592330267677`*^9, 3.7143595380002937`*^9, 3.714359974712551*^9, 
   3.714420100531733*^9, 3.71442894630612*^9, 3.7144290291588984`*^9, 
   3.714430171154084*^9, 3.714431477518258*^9, 3.714433270756939*^9, 
   3.7144334835091267`*^9, 3.714433536524596*^9, 3.714433605816877*^9, 
   3.714434085076776*^9, 3.714434121878605*^9, 3.71443612879692*^9, 
   3.714436252861206*^9, 3.714436549383505*^9, {3.7144366608933687`*^9, 
   3.7144366904161386`*^9}, 3.7144367235094967`*^9, 3.714437379931266*^9, {
   3.714437607612681*^9, 3.714437634609991*^9}}]
}, Open  ]]
}, Open  ]],

Cell["\<\
and the condition is not satisfied for gasses with low degrees of freedom.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7143512530433073`*^9, 3.71435127212434*^9}, {
  3.7144326032483587`*^9, 3.714432627908494*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part d.", "Section",
 CellChangeTimes->{{3.7143512877165422`*^9, 3.7143512891046963`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Find the lapse rate for the Earth given the value for the polytropic index \
calculated in Part c.\
\>", "Subsection",
 CellChangeTimes->{{3.714351300097534*^9, 3.714351334740823*^9}}],

Cell[CellGroupData[{

Cell["The lapse rate is given by Longcope (2.18) as", "Subsubsection",
 CellChangeTimes->{{3.714351399727437*^9, 3.7143514201923857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dTdz$", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "'"}], "[", "z", "]"}], "\[Rule]", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox["1", "\[CapitalGamma]"]}], ")"}]}], "  ", 
     FractionBox[
      RowBox[{"m", " ", "g"}], "kB"]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714351423964603*^9, 3.71435150131878*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plugging in the value for the polytropic index calculated for Part c. gives\
\>", "Subsubsection",
 CellChangeTimes->{{3.7143515551145363`*^9, 3.714351583873021*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dTdz$d", " ", "=", " ", 
    RowBox[{"dTdz$", " ", "/.", " ", "\[CapitalGamma]$c"}]}], ")"}], " ", "//",
   "Framed"}]], "Input",
 CellChangeTimes->{{3.714351590710371*^9, 3.71435159911548*^9}, {
  3.714351637198514*^9, 3.714351642033629*^9}, {3.7143516732332582`*^9, 
  3.714351685765005*^9}, {3.714352357271893*^9, 3.714352395442918*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["T", "\[Prime]",
     MultilineFunction->None], "[", "z", "]"}], "\[Rule]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"g", " ", "m"}], 
     RowBox[{"8", " ", "kB"}]]}]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.714352395797161*^9, {3.714352943406831*^9, 3.7143529714125347`*^9}, 
   3.7143592332007017`*^9, 3.714359538163056*^9, 3.7143599749090157`*^9, 
   3.714420100743705*^9, 3.714428946482719*^9, 3.714429029421444*^9, 
   3.714430171354311*^9, 3.714431477803381*^9, 3.7144332709536877`*^9, 
   3.714433483796132*^9, 3.714433536810964*^9, 3.7144336060862083`*^9, 
   3.71443408545501*^9, 3.7144341220712976`*^9, 3.7144361290780888`*^9, 
   3.714436253203784*^9, 3.714436549641111*^9, {3.714436661185083*^9, 
   3.7144366906712713`*^9}, 3.7144367237839937`*^9, 3.714437380217112*^9, {
   3.714437607806287*^9, 3.71443763487106*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluated numerically, this is", "Subsubsection",
 CellChangeTimes->{{3.7143527846516733`*^9, 3.714352808334786*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dTdz$dv", " ", "=", " ", 
    RowBox[{
     RowBox[{"dTdz$d", " ", "/.", " ", "vals"}], " ", "//", "UnitConvert"}]}],
    ")"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.714352372976516*^9, 3.714352389197052*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["T", "\[Prime]",
     MultilineFunction->None], "[", "z", "]"}], "\[Rule]", 
   TemplateBox[{
    RowBox[{"-", "0.00426967879843524`"}],
     RowBox[{"\"K\"", "\[InvisibleSpace]", "\"/\"", "\[InvisibleSpace]", 
       "\"m\""}],"kelvins difference per meter",FractionBox[
     "\"KelvinsDifference\"", "\"Meters\""]},
    "Quantity"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.7143523906150293`*^9, {3.714352943605937*^9, 3.714352971615581*^9}, 
   3.714359233330965*^9, 3.7143595382809687`*^9, 3.714359975065021*^9, 
   3.7144201009384527`*^9, 3.714428946657206*^9, 3.714429029611989*^9, 
   3.714430171569487*^9, 3.71443147798632*^9, 3.714433271140766*^9, 
   3.7144334839944677`*^9, 3.714433537008806*^9, 3.714433606369145*^9, 
   3.714434085670001*^9, 3.7144341222679358`*^9, 3.7144361292999277`*^9, 
   3.714436253421762*^9, 3.7144365498480988`*^9, {3.714436661407651*^9, 
   3.714436690861484*^9}, 3.7144367239650803`*^9, 3.714437380429188*^9, {
   3.71443760802181*^9, 3.71443763506244*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find the height of the tropopause for the Earth", "Subsection",
 CellChangeTimes->{{3.7143517247040873`*^9, 3.714351735339085*^9}}],

Cell[CellGroupData[{

Cell["We are given that the temperature at sea level is", "Subsubsection",
 CellChangeTimes->{{3.714352438144381*^9, 3.7143524557620173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T0$d", " ", "=", 
   RowBox[{
    RowBox[{"T", "[", "0", "]"}], " ", "\[Equal]", "  ", "T0\[Earth]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714352516895033*^9, 3.714352537729995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"vals", ",", " ", 
    RowBox[{"T0\[Earth]", "\[Rule]", " ", 
     RowBox[{"300", 
      TemplateBox[{
       InterpretationBox["\[InvisibleSpace]", 1],"\"K\"","kelvins difference",
        "\"KelvinsDifference\""},
       "Quantity"]}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.714352465401939*^9, 3.714352511467371*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrate the lapse rate using the initial condition", "Subsubsection",
 CellChangeTimes->{{3.71435241749479*^9, 3.714352422942762*^9}, {
  3.714352550485743*^9, 3.714352555402836*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T$d", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dTdz$d", "/.", " ", 
         RowBox[{"Rule", "\[Rule]", " ", "Equal"}]}], ",", " ", "T0$d"}], 
       "}"}], ",", 
      RowBox[{"T", "[", "z", "]"}], ",", "z"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.714352424740052*^9, 3.714352428314744*^9}, {
  3.7143525407021503`*^9, 3.714352624053586*^9}, {3.7143526848332*^9, 
  3.714352689205967*^9}, {3.714420088596184*^9, 3.7144200899689283`*^9}, {
  3.714428975784917*^9, 3.714429023298521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", "z", "]"}], "\[Rule]", 
  RowBox[{"T0\[Earth]", "-", 
   FractionBox[
    RowBox[{"g", " ", "m", " ", "z"}], 
    RowBox[{"8", " ", "kB"}]]}]}]], "Output",
 CellChangeTimes->{{3.7143525662216*^9, 3.7143525857556067`*^9}, {
   3.714352616191721*^9, 3.7143526243047543`*^9}, 3.714352689677593*^9, {
   3.714352943957055*^9, 3.7143529718831263`*^9}, 3.7143592335511093`*^9, 
   3.7143595384651012`*^9, 3.7143599752553587`*^9, {3.714420090520772*^9, 
   3.714420101154553*^9}, 3.7144289468293943`*^9, {3.714428977625752*^9, 
   3.7144290298778*^9}, 3.714430171852852*^9, 3.714431478270217*^9, 
   3.714433271599278*^9, 3.7144334844619293`*^9, 3.7144335374660063`*^9, 
   3.7144336068166*^9, 3.7144340859396257`*^9, 3.7144341225676317`*^9, 
   3.7144361295504293`*^9, 3.714436253710696*^9, 3.7144365501443167`*^9, {
   3.714436661695907*^9, 3.714436691082995*^9}, 3.714436724255638*^9, 
   3.714437380772646*^9, {3.714437608315263*^9, 3.7144376353510113`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
and solve for the height at which it is equal to the effective temperature\
\>", "Subsubsection",
 CellChangeTimes->{{3.714352637571604*^9, 3.714352651319646*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"ztp$d", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", "z", "]"}], " ", "\[Equal]", " ", "Teff"}], "/.", 
         "T$d"}], "/.", " ", 
        RowBox[{"z", "\[Rule]", " ", "ztp"}]}], ",", "ztp"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}], "  ", "//", 
  "Framed"}]], "Input",
 CellChangeTimes->{{3.714352661388636*^9, 3.71435276235973*^9}, {
  3.714428930349639*^9, 3.714428957837756*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"ztp", "\[Rule]", 
   FractionBox[
    RowBox[{"8", " ", "kB", " ", 
     RowBox[{"(", 
      RowBox[{"T0\[Earth]", "-", "Teff"}], ")"}]}], 
    RowBox[{"g", " ", "m"}]]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.714352694094022*^9, 3.714352762606489*^9}, {
   3.71435294412362*^9, 3.714352972108005*^9}, 3.714359233680728*^9, 
   3.714359538566379*^9, 3.714359975385983*^9, 3.714420101311549*^9, {
   3.714428935286749*^9, 3.7144289646450653`*^9}, 3.714429030029088*^9, 
   3.714430172077319*^9, 3.714431478451454*^9, 3.714433272316861*^9, 
   3.714433485179173*^9, 3.714433538283592*^9, 3.714433607099598*^9, 
   3.714434086178746*^9, 3.714434122789831*^9, 3.714436129786881*^9, 
   3.714436253895029*^9, 3.71443655038973*^9, {3.714436661910933*^9, 
   3.714436691305542*^9}, 3.71443672447831*^9, 3.7144373809902277`*^9, {
   3.714437608508181*^9, 3.714437635554694*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluated numerically, this is", "Subsubsection",
 CellChangeTimes->{{3.714352795999669*^9, 3.7143528143838177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"ztp$dV", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ztp$d", "/.", " ", 
       RowBox[{"Teff", " ", "\[Rule]", " ", "Teff\[Earth]"}]}], " ", "/.", 
      " ", "vals"}], " ", "//", "UnitConvert"}]}], ")"}], " ", "//", 
  "Framed"}]], "Input",
 CellChangeTimes->{{3.714352819672265*^9, 3.7143528490184307`*^9}, {
  3.714353027776675*^9, 3.714353039208592*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"ztp", "\[Rule]", 
   TemplateBox[{"14052.579323294513`","\"m\"","meters","\"Meters\""},
    "Quantity"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.714352822572267*^9, 3.714352849632056*^9}, {
   3.7143529442983913`*^9, 3.714352972288477*^9}, {3.714353033409368*^9, 
   3.714353039456243*^9}, 3.714359233809518*^9, 3.71435953871495*^9, 
   3.714359975554873*^9, 3.714420101503683*^9, 3.71442894730606*^9, 
   3.714429030189419*^9, 3.714430172249897*^9, 3.714431478696957*^9, 
   3.7144332727000933`*^9, 3.7144334855291653`*^9, 3.714433538499106*^9, 
   3.7144336073489113`*^9, 3.714434086403819*^9, 3.714434123163828*^9, 
   3.714436129997319*^9, 3.714436254161069*^9, 3.714436550579803*^9, {
   3.71443666215327*^9, 3.714436691554386*^9}, 3.714436724742313*^9, 
   3.714437381237438*^9, {3.714437608709086*^9, 3.71443763579836*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part e.", "Section",
 CellChangeTimes->{{3.7143530489666233`*^9, 3.7143530503350077`*^9}}],

Cell[CellGroupData[{

Cell["Find an expression for the surface temperature", "Subsection",
 CellChangeTimes->{{3.714353388713456*^9, 3.714353398898221*^9}}],

Cell[CellGroupData[{

Cell["\<\
In the problem statement, we are told that the surface temperature takes the \
form\
\>", "Subsubsection",
 CellChangeTimes->{{3.714353420179761*^9, 3.71435344453854*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"T0$e", " ", "=", " ", 
    RowBox[{
     RowBox[{"T", "[", "0", "]"}], "\[Rule]", 
     RowBox[{"Teff", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"p", "[", "0", "]"}], "C0"], ")"}], "b"]}]}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.714353449633965*^9, 3.7143535008747997`*^9}, {
  3.7144301593992767`*^9, 3.71443016157143*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve the ideal gas law for temperature and plug in polytropic density\
\>", "Subsubsection",
 CellChangeTimes->{{3.714359034415597*^9, 3.714359050810869*^9}, {
  3.714359173216734*^9, 3.714359208813167*^9}, {3.714359611486471*^9, 
  3.714359619175527*^9}, {3.714429074467456*^9, 3.7144290813635073`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tp$e", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"p$", "[", "z", "]"}], "/.", 
       RowBox[{"Rule", "\[Rule]", " ", "Equal"}]}], ",", 
      RowBox[{"T", "[", "z", "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "\[Rho]$"}]}]], "Input",
 CellChangeTimes->{{3.7143594015237713`*^9, 3.7143594057288837`*^9}, {
   3.7143595303659143`*^9, 3.714359599964752*^9}, {3.714360127305283*^9, 
   3.7143601277465878`*^9}, {3.714428736235849*^9, 3.7144287383155403`*^9}, 
   3.7144292267663717`*^9, 3.714431463931855*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", "z", "]"}], "\[Rule]", 
  FractionBox[
   RowBox[{"m", " ", 
    SuperscriptBox[
     RowBox[{"p", "[", "z", "]"}], 
     RowBox[{"1", "-", 
      FractionBox["1", "\[CapitalGamma]"]}]]}], 
   RowBox[{"K0", " ", "kB"}]]}]], "Output",
 CellChangeTimes->{{3.714359532318874*^9, 3.71435960033247*^9}, 
   3.714359975985593*^9, 3.714360128379141*^9, 3.7144201018661327`*^9, 
   3.714428739074525*^9, 3.714428947621388*^9, 3.714429030524269*^9, 
   3.714429228720191*^9, 3.714430172506522*^9, {3.714431467643096*^9, 
   3.7144314789976377`*^9}, 3.714433272875699*^9, 3.714433485722549*^9, 
   3.714433538833288*^9, 3.714433607735361*^9, 3.71443408657889*^9, 
   3.71443412336725*^9, 3.714436130298211*^9, 3.714436254421719*^9, 
   3.714436550860593*^9, {3.714436662468301*^9, 3.714436691774221*^9}, 
   3.714436724954026*^9, 3.7144373815225763`*^9, {3.7144376089067287`*^9, 
   3.714437635988097*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Grouping the constants allows us to construct a polytropic invariant, \
\[Lambda]\
\>", "Subsubsection",
 CellChangeTimes->{{3.714429100860886*^9, 3.7144291671711063`*^9}, {
  3.714429209499255*^9, 3.714429215699018*^9}, {3.714429248607622*^9, 
  3.7144292641205883`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]$e", "[", "z_", "]"}], "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tp$e", " ", "/.", " ", "r2e"}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m", " ", "/", " ", 
         RowBox[{"(", 
          RowBox[{"K0", " ", "kB"}], ")"}]}], ")"}], " ", "\[Rule]", " ", 
       "\[Lambda]"}]}], ",", " ", "\[Lambda]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.714429272616054*^9, 3.714429365630825*^9}, {
   3.714430086794064*^9, 3.714430088984662*^9}, 3.7144314720819817`*^9}],

Cell[BoxData[
 RowBox[{"\[Lambda]", "\[Rule]", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"p", "[", "z", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["1", "\[CapitalGamma]"]}]], " ", 
   RowBox[{"T", "[", "z", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.714429285786933*^9, {3.714429316937574*^9, 3.71442936613019*^9}, 
   3.7144300895259523`*^9, 3.714430172779008*^9, {3.7144314726914463`*^9, 
   3.7144314791880293`*^9}, 3.714433273074448*^9, 3.714433485930393*^9, 
   3.714433539056336*^9, 3.714433608131526*^9, 3.7144340868005667`*^9, 
   3.71443412358226*^9, 3.714436130545879*^9, 3.714436254631042*^9, 
   3.714436551108213*^9, {3.714436662784523*^9, 3.714436691992793*^9}, 
   3.714436725160075*^9, 3.7144373817007217`*^9, {3.714437609107485*^9, 
   3.714437636208365*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Since \[Lambda] is constant over the entire atmosphere, we can use two \
known points, z=0 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "=", 
    SubscriptBox["z", "tp"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "to solve for the surface temperature"
}], "Subsubsection",
 CellChangeTimes->{{3.714429408348612*^9, 3.714429501504497*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e$e", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]$e", "[", "0", "]"}], " ", "/.", " ", "r2e"}], " ", "/.",
    " ", 
   RowBox[{"\[Lambda]$e", "[", "ztp", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7144295121906633`*^9, 3.7144295279037447`*^9}, {
  3.714429592279245*^9, 3.714429594068988*^9}, {3.714430077561595*^9, 
  3.71443009305457*^9}, {3.7144301879333076`*^9, 3.714430188022996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"p", "[", "ztp", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["1", "\[CapitalGamma]"]}]], " ", 
   RowBox[{"T", "[", "ztp", "]"}]}], "\[Equal]", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"p", "[", "0", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["1", "\[CapitalGamma]"]}]], " ", 
   RowBox[{"T", "[", "0", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.714429517875786*^9, 3.7144295283996*^9}, 
   3.7144295945843153`*^9, {3.714430078201755*^9, 3.714430093726959*^9}, {
   3.7144301730852623`*^9, 3.7144301881587543`*^9}, 3.714431479373137*^9, 
   3.714433273261773*^9, 3.714433486163547*^9, 3.7144335392438927`*^9, 
   3.714433608410337*^9, 3.7144340870200663`*^9, 3.714434123801159*^9, 
   3.714436130713085*^9, 3.7144362548421583`*^9, 3.714436551279686*^9, {
   3.714436663093636*^9, 3.7144366922457867`*^9}, 3.71443672538548*^9, 
   3.714437381886129*^9, {3.714437609289564*^9, 3.714437636430879*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Plug in the pressure at the tropopause found in Part a., and the temperature \
at the tropopause, defined in the problem statement, and the form of the \
surface temperature\
\>", "Subsubsection",
 CellChangeTimes->{{3.71442960977098*^9, 3.714429675394648*^9}, {
  3.714429791014269*^9, 3.714429796657385*^9}, {3.7144298792119827`*^9, 
  3.714429886599959*^9}, {3.714429958884556*^9, 3.7144299711998997`*^9}, {
  3.7144300042700167`*^9, 3.714430012378665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e1$e", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e$e", " ", "/.", "pztp$a"}], "/.", " ", "Tztp$"}], "/.", " ", 
    "T0$e"}], " ", "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.714429737818309*^9, 3.7144297519904833`*^9}, {
  3.714429940700446*^9, 3.714429943066409*^9}, {3.714429976693029*^9, 
  3.714429986336357*^9}, {3.7144300204696417`*^9, 3.714430025205248*^9}, {
  3.714430067909401*^9, 3.7144300745599203`*^9}, {3.714430202628417*^9, 
  3.714430203943362*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"g", " ", "m"}], "\[Sigma]ir"], ")"}], 
    FractionBox["1", "\[CapitalGamma]"]], " ", "\[Sigma]ir"}], "\[Equal]", 
  RowBox[{"g", " ", "m", " ", 
   SuperscriptBox[
    RowBox[{"p", "[", "0", "]"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["1", "\[CapitalGamma]"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"p", "[", "0", "]"}], "C0"], ")"}], "b"]}]}]], "Output",
 CellChangeTimes->{
  3.714429943334681*^9, 3.7144299876955767`*^9, 3.714430025678647*^9, 
   3.7144300965053377`*^9, {3.714430173393878*^9, 3.7144302042184973`*^9}, 
   3.714431479594398*^9, 3.714433273512889*^9, 3.714433486346974*^9, 
   3.714433539444951*^9, 3.714433608723009*^9, 3.7144340873518867`*^9, 
   3.714434124124775*^9, 3.714436131097478*^9, 3.7144362552163343`*^9, 
   3.7144365516371593`*^9, {3.714436663406611*^9, 3.714436692618217*^9}, 
   3.714436725719389*^9, 3.7144373821802273`*^9, {3.714437609478528*^9, 
   3.7144376367343388`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve for the constants b and C0", "Subsubsection",
 CellChangeTimes->{{3.7144306210449667`*^9, 3.714430625565996*^9}, {
  3.714430668599049*^9, 3.714430678684307*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b$e", ",", " ", "C0$e"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"e1$e", ",", " ", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"p", "[", "0", "]"}], 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              FractionBox["1", "\[CapitalGamma]"]}]], 
            SuperscriptBox[
             RowBox[{"p", "[", "0", "]"}], "b"]}], "\[Equal]", "1"}]}], " ", 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"b", ",", "C0"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "//", "Quiet"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.714430681744*^9, 3.714430712707027*^9}, {
  3.714430746648273*^9, 3.714430813956608*^9}, {3.714430863336307*^9, 
  3.714430963303911*^9}, {3.714430993514806*^9, 3.7144310118602457`*^9}, {
  3.714431385001409*^9, 3.7144314042622223`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"b$e", " ", "//", "Framed"}], "\[IndentingNewLine]", 
 RowBox[{"C0$e", " ", "//", "Framed"}]}], "Input",
 CellChangeTimes->{{3.714431016218108*^9, 3.714431026523707*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"b", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[CapitalGamma]"}], "\[CapitalGamma]"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.71443101986307*^9, 3.714431026732008*^9}, 
   3.714431395819441*^9, 3.7144314798129597`*^9, 3.71443327380797*^9, 
   3.7144334865903482`*^9, 3.714433539797495*^9, 3.7144336091448727`*^9, 
   3.714434087560463*^9, 3.714434124494169*^9, 3.714436131333549*^9, 
   3.714436255501091*^9, 3.7144365519174643`*^9, {3.714436663612605*^9, 
   3.7144366929003487`*^9}, 3.714436726018654*^9, 3.714437382429019*^9, {
   3.7144376097573013`*^9, 3.71443763704631*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{"C0", "\[Rule]", 
   FractionBox[
    RowBox[{"g", " ", "m"}], "\[Sigma]ir"]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.71443101986307*^9, 3.714431026732008*^9}, 
   3.714431395819441*^9, 3.7144314798129597`*^9, 3.71443327380797*^9, 
   3.7144334865903482`*^9, 3.714433539797495*^9, 3.7144336091448727`*^9, 
   3.714434087560463*^9, 3.714434124494169*^9, 3.714436131333549*^9, 
   3.714436255501091*^9, 3.7144365519174643`*^9, {3.714436663612605*^9, 
   3.7144366929003487`*^9}, 3.714436726018654*^9, 3.714437382429019*^9, {
   3.7144376097573013`*^9, 3.71443763721968*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["So the temperature at the surface is then", "Subsubsection",
 CellChangeTimes->{{3.714431827619619*^9, 3.71443183343953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T0e$e", " ", "=", " ", 
    RowBox[{
     RowBox[{"T0$e", " ", "/.", " ", "b$e"}], " ", "/.", " ", "C0$e"}]}], " ",
    ")"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.7144318684997387`*^9, 3.714431916372251*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{"T", "[", "0", "]"}], "\[Rule]", 
   RowBox[{"Teff", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"\[Sigma]ir", " ", 
        RowBox[{"p", "[", "0", "]"}]}], 
       RowBox[{"g", " ", "m"}]], ")"}], 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[CapitalGamma]"}], "\[CapitalGamma]"]]}]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.714431847638895*^9, 3.714431885961112*^9, 3.714431916568631*^9, 
   3.714433274130623*^9, 3.7144334869476957`*^9, 3.714433540124714*^9, 
   3.714433609635498*^9, 3.714434087968701*^9, 3.714434124989461*^9, 
   3.714436131791708*^9, 3.714436256301704*^9, 3.714436552345652*^9, {
   3.714436664014984*^9, 3.7144366935231752`*^9}, 3.714436726444097*^9, 
   3.714437382841209*^9, {3.714437610253574*^9, 3.714437637435071*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determine the temperature increase from a doubled scattering cross section\
\>", "Subsection",
 CellChangeTimes->{{3.714431241739959*^9, 3.714431292492038*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Construct a ratio of the doubled and unmodified ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "ir"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.714431647595237*^9, 3.714431689331485*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{"2", "\[Sigma]ir"}], "]"}], "/", 
    RowBox[{"T", "[", "\[Sigma]ir", "]"}]}], "\[Rule]", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "[", "0", "]"}], " ", "/.", "T0e$e"}], "/.", " ", 
      RowBox[{"\[Sigma]ir", " ", "\[Rule]", " ", 
       RowBox[{"2", "\[Sigma]ir"}]}]}], ")"}], " ", "/", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", "0", "]"}], " ", "/.", "T0e$e"}], ")"}]}]}], " ", "//",
   "Framed"}]], "Input",
 CellChangeTimes->{{3.7144315209590483`*^9, 3.714431596877461*^9}, {
  3.714431635375863*^9, 3.714431640828933*^9}, {3.714431701013942*^9, 
  3.7144317501730347`*^9}, {3.7144318950492477`*^9, 3.7144319059805603`*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   FractionBox[
    RowBox[{"T", "[", 
     RowBox[{"2", " ", "\[Sigma]ir"}], "]"}], 
    RowBox[{"T", "[", "\[Sigma]ir", "]"}]], "\[Rule]", 
   SuperscriptBox["2", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[CapitalGamma]"}], "\[CapitalGamma]"]]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.714431906482769*^9, 3.71443327434593*^9, 3.7144334871478233`*^9, 
   3.714433540348487*^9, 3.714433609893148*^9, 3.714434088182192*^9, 
   3.714434125205844*^9, 3.714436132086042*^9, 3.714436256669046*^9, 
   3.71443655259238*^9, {3.714436664191352*^9, 3.714436693757822*^9}, 
   3.714436726680037*^9, 3.714437383022511*^9, {3.714437610394087*^9, 
   3.714437637678728*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part f.", "Section",
 CellChangeTimes->{{3.714431772827112*^9, 3.7144317743012047`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Divide the heat flux by the hydrostatic balance equation to obtain a \
differential equation with T as the dependent variable and p as the dependent \
variable\
\>", "Subsection",
 CellChangeTimes->{{3.714432482562397*^9, 3.714432573191718*^9}}],

Cell[CellGroupData[{

Cell["\<\
The hydrostatic balance equation can be written as (Longcope 2.1)\
\>", "Subsubsection",
 CellChangeTimes->{{3.714432861147026*^9, 3.714432874674139*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dpdz$f", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "'"}], "[", "z", "]"}], " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"\[Rho]", "[", "z", "]"}], " ", "g"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714432943752028*^9, 3.71443298606968*^9}, {
  3.71443325327038*^9, 3.714433254589281*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["The heat flux through the atmosphere is given by", "Subsubsection",
 CellChangeTimes->{{3.7144330563183517`*^9, 3.714433073199524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dTdz$f", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "'"}], "[", "z", "]"}], " ", "\[Rule]", " ", 
    RowBox[{"-", 
     FractionBox["F", 
      RowBox[{"\[Kappa]", "[", "z", "]"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714433121462535*^9, 3.714433171517974*^9}, {
  3.714433263619302*^9, 3.714433264156171*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["So the differential equation we\[CloseCurlyQuote]re looking for is", \
"Subsubsection",
 CellChangeTimes->{{3.71443317836812*^9, 3.714433191420271*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"dTdp$f", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "'"}], "[", "p", "]"}], " ", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"T", "'"}], "[", "z", "]"}], 
               RowBox[{
                RowBox[{"p", "'"}], "[", "z", "]"}]], "/.", "dpdz$f"}], " ", "/.",
              " ", "dTdz$f"}], " ", "/.", " ", 
            RowBox[{"F", "\[Rule]", " ", "F0"}]}], " ", "/.", " ", "F0E$"}], 
          " ", "/.", " ", 
          RowBox[{
           RowBox[{"\[Kappa]", "[", "z", "]"}], "\[Rule]", " ", 
           "\[Kappa]rad"}]}], " ", "/.", " ", "\[Kappa]rad$"}], " ", "/.", 
        " ", 
        RowBox[{"lmfp$", "[", "z", "]"}]}], "/.", 
       RowBox[{"T", "\[Rule]", " ", 
        RowBox[{"T", "[", "p", "]"}]}]}], ")"}]}]}], ")"}], " ", "//", 
  "Framed"}]], "Input",
 CellChangeTimes->{{3.714433195903314*^9, 3.71443324463485*^9}, {
   3.714433281262231*^9, 3.7144333240915203`*^9}, {3.714433375214334*^9, 
   3.714433384266111*^9}, {3.714433440387521*^9, 3.714433479501425*^9}, {
   3.7144335226910954`*^9, 3.714433525858096*^9}, 3.714433557009112*^9, {
   3.7144337191605577`*^9, 3.7144337233462963`*^9}, {3.714433948059026*^9, 
   3.7144339559274406`*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["T", "\[Prime]",
     MultilineFunction->None], "[", "p", "]"}], "\[Rule]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Teff", "4"], " ", "\[Sigma]ir"}], 
     RowBox[{"8", " ", "g", " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"T", "[", "p", "]"}], "3"]}]]}]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.714433245094623*^9, 3.714433324358498*^9}, {
   3.714433369816437*^9, 3.7144333846686974`*^9}, {3.7144334444238453`*^9, 
   3.714433487339192*^9}, {3.714433530601577*^9, 3.714433540568529*^9}, 
   3.7144336103704023`*^9, 3.7144337235891733`*^9, 3.71443395696646*^9, 
   3.714434088439885*^9, 3.7144341254897118`*^9, 3.7144361323301477`*^9, 
   3.714436257009466*^9, 3.714436552895611*^9, {3.7144366644281073`*^9, 
   3.714436694051743*^9}, 3.71443672695317*^9, 3.7144373833675528`*^9, {
   3.714437610678046*^9, 3.71443763794526*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Solve the differential equation using the temperature at the troposphere\
\>", "Subsection",
 CellChangeTimes->{{3.714433735017844*^9, 3.714433768724988*^9}}],

Cell[CellGroupData[{

Cell["We are given the initial condition", "Subsubsection",
 CellChangeTimes->{{3.71443378215213*^9, 3.714433788342174*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tptr$f", " ", "=", " ", 
   RowBox[{
    RowBox[{"T", "[", "ptr", "]"}], " ", "\[Rule]", " ", "Teff"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714433835818321*^9, 3.714433862902125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
which allows us to immediately solve the differential equation\
\>", "Subsubsection",
 CellChangeTimes->{{3.714433868465596*^9, 3.714433905018918*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{"T$f", " ", "=", " ", 
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dTdp$f", ",", " ", "Tptr$f"}], "}"}], " ", "/.", " ", 
       "r2e"}], ",", 
      RowBox[{"T", "[", "p", "]"}], ",", "p"}], "]"}], " ", "//", 
    "FullSimplify"}]}], ")"}]], "Input",
 CellChangeTimes->{{3.7144339065410357`*^9, 3.714433935021481*^9}, {
  3.714433974186967*^9, 3.714433988971431*^9}, {3.714434019847088*^9, 
  3.714434044729486*^9}, {3.714434136133202*^9, 3.714434153925907*^9}, {
  3.714434191005117*^9, 3.714434193844779*^9}, {3.714440524812902*^9, 
  3.7144405609423313`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", "p", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "Teff"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "ptr"}], ")"}], " ", "\[Sigma]ir"}], 
          RowBox[{"2", " ", "g", " ", "m"}]]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", "p", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "Teff", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "ptr"}], ")"}], " ", "\[Sigma]ir"}], 
          RowBox[{"2", " ", "g", " ", "m"}]]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", "p", "]"}], "\[Rule]", 
     RowBox[{"\[ImaginaryI]", " ", "Teff", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "ptr"}], ")"}], " ", "\[Sigma]ir"}], 
          RowBox[{"2", " ", "g", " ", "m"}]]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T", "[", "p", "]"}], "\[Rule]", 
     RowBox[{"Teff", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "ptr"}], ")"}], " ", "\[Sigma]ir"}], 
          RowBox[{"2", " ", "g", " ", "m"}]]}], ")"}], 
       RowBox[{"1", "/", "4"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714433937562001*^9, 3.714433989228808*^9}, {
   3.7144340217963142`*^9, 3.7144340450583487`*^9}, 3.7144340888853083`*^9, {
   3.7144341258753223`*^9, 3.714434136395995*^9}, {3.714434181278901*^9, 
   3.714434194501748*^9}, 3.714436132770844*^9, 3.714436257447421*^9, 
   3.714436553344401*^9, {3.714436664794447*^9, 3.714436694426084*^9}, 
   3.714436727395854*^9, 3.7144373837886963`*^9, {3.714437610911284*^9, 
   3.71443763838479*^9}, {3.714440525520834*^9, 3.7144405612518263`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determine the surface temperature", "Subsection",
 CellChangeTimes->{{3.714434199509901*^9, 3.714434205900861*^9}}],

Cell[CellGroupData[{

Cell["\<\
Evaluate the temperature determined in the previous cell at the pressure at \
the surface\
\>", "Subsubsection",
 CellChangeTimes->{{3.7144342158798656`*^9, 3.7144342350109243`*^9}, {
  3.7144343650699873`*^9, 3.714434373806052*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T0$f", " ", "=", " ", 
  RowBox[{
   RowBox[{"T$f", " ", "/.", " ", 
    RowBox[{"p", "\[Rule]", " ", "p0"}]}], " ", "//", "Framed"}]}]], "Input",
 CellChangeTimes->{{3.7144342637452307`*^9, 3.714434308638714*^9}}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{"T", "[", "p0", "]"}], "\[Rule]", 
   RowBox[{"Teff", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "p0"}], "+", "ptr"}], ")"}], " ", "\[Sigma]ir"}], 
        RowBox[{"2", " ", "g", " ", "m"}]]}], ")"}], 
     RowBox[{"1", "/", "4"}]]}]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.71443426816774*^9, 3.714434308965234*^9}, 
   3.714436132985757*^9, 3.7144362577391*^9, 3.71443655359122*^9, {
   3.714436664996969*^9, 3.7144366946099873`*^9}, 3.71443672763663*^9, 
   3.714437383975443*^9, {3.714437611253579*^9, 3.7144376385431223`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part g.", "Section",
 CellChangeTimes->{{3.714434613244523*^9, 3.714434615129607*^9}}],

Cell[CellGroupData[{

Cell["Find the pressure-density relation for the troposphere", "Subsection",
 CellChangeTimes->{{3.7144346408317747`*^9, 3.714434649151856*^9}}],

Cell[CellGroupData[{

Cell["Solve the ideal gas law for temperature", "Subsubsection",
 CellChangeTimes->{{3.714434909600572*^9, 3.7144349167125607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Ti$g", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p$", "[", "z", "]"}], " ", "/.", " ", "r2e"}], ",", " ", 
     RowBox[{"T", "[", "z", "]"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.714434920767056*^9, 3.714434968002541*^9}, {
  3.7144351107792587`*^9, 3.714435114562709*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "[", "z", "]"}], "\[Rule]", 
  FractionBox[
   RowBox[{"m", " ", 
    RowBox[{"p", "[", "z", "]"}]}], 
   RowBox[{"kB", " ", 
    RowBox[{"\[Rho]", "[", "z", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.7144349233783712`*^9, 3.714434968311988*^9}, 
   3.714435115057623*^9, 3.714436133285626*^9, 3.7144362579347153`*^9, 
   3.714436553819098*^9, {3.714436665213929*^9, 3.71443669482767*^9}, 
   3.714436727847657*^9, 3.7144373841601686`*^9, {3.7144376114480762`*^9, 
   3.714437638718549*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", " ", "=", " ", 
  RowBox[{"$Assumptions", "&&", "  ", 
   RowBox[{
    RowBox[{"p", "[", "z", "]"}], "<", " ", 
    RowBox[{"ptr", " ", "+", " ", 
     FractionBox[
      RowBox[{"2", " ", "g", " ", "m"}], "\[Sigma]ir"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.714437425414534*^9, 3.714437468394986*^9}, {
  3.714437601679318*^9, 3.714437602836975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cs", ">", "0"}], "&&", 
  RowBox[{"g", ">", "0"}], "&&", 
  RowBox[{"ztp", ">", "0"}], "&&", 
  RowBox[{"\[Sigma]ir", ">", "0"}], "&&", 
  RowBox[{"m", ">", "0"}], "&&", 
  RowBox[{
   RowBox[{"\[Rho]", "[", "z", "]"}], ">", "0"}], "&&", 
  RowBox[{"kB", ">", "0"}], "&&", 
  RowBox[{"\[CapitalGamma]", ">", "0"}], "&&", 
  RowBox[{"ptr", ">", "0"}], "&&", 
  RowBox[{"Teff", ">", "0"}], "&&", 
  RowBox[{"p", ">", "ptr"}], "&&", 
  RowBox[{"f", ">", "1"}], "&&", 
  RowBox[{
   RowBox[{"p", "[", "z", "]"}], "<", 
   RowBox[{"ptr", "+", 
    FractionBox[
     RowBox[{"2", " ", "g", " ", "m"}], "\[Sigma]ir"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7144374973978453`*^9, {3.714437611626957*^9, 3.714437638969228*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Set equal to the solution from Part f. and solve for the density\
\>", "Subsubsection",
 CellChangeTimes->{{3.714435174270339*^9, 3.714435188519603*^9}, {
  3.7144371042615433`*^9, 3.714437116305222*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[Rho]$g", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"T$f", " ", "/.", 
             RowBox[{
              RowBox[{"T", "[", "p", "]"}], "\[Rule]", " ", 
              RowBox[{"T", "[", "z", "]"}]}]}], " ", "/.", " ", 
            RowBox[{"p", "\[Rule]", " ", 
             RowBox[{"p", "[", "z", "]"}]}]}], "/.", " ", "Ti$g"}], " ", "/.",
           " ", "r2e"}], ",", 
         RowBox[{"\[Rho]", "[", "z", "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "PowerExpand"}], " ", 
     "]"}]}], ")"}], " ", "//", "Framed"}]], "Input",
 CellChangeTimes->{{3.714435548218177*^9, 3.714435556805416*^9}, {
   3.71443577360392*^9, 3.714435810268189*^9}, {3.7144360333990183`*^9, 
   3.714436070082993*^9}, 3.714436207158203*^9, {3.714436312136162*^9, 
   3.714436314176372*^9}, {3.714436363209846*^9, 3.7144363691192493`*^9}, {
   3.714436452285434*^9, 3.714436464419421*^9}, {3.7144365097193604`*^9, 
   3.7144365279138107`*^9}, {3.714436852308153*^9, 3.714436874430695*^9}, {
   3.7144369422648363`*^9, 3.714436997445557*^9}, {3.714437040527454*^9, 
   3.714437053223159*^9}, {3.714437096738755*^9, 3.71443709992028*^9}, {
   3.714437156749799*^9, 3.714437159370441*^9}, 3.714437360405965*^9, 
   3.714437557918222*^9}],

Cell[BoxData[
 FrameBox[
  RowBox[{
   RowBox[{"\[Rho]", "[", "z", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "/", "4"}]], " ", 
     RowBox[{"p", "[", "z", "]"}]}], 
    RowBox[{"kB", " ", "Teff", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "g", " ", "m"}], "+", 
         RowBox[{"ptr", " ", "\[Sigma]ir"}], "-", 
         RowBox[{"\[Sigma]ir", " ", 
          RowBox[{"p", "[", "z", "]"}]}]}], 
        RowBox[{"g", " ", 
         SuperscriptBox["m", "5"]}]], ")"}], 
      RowBox[{"1", "/", "4"}]]}]]}],
  StripOnInput->False]], "Output",
 CellChangeTimes->{
  3.7144357813957663`*^9, 3.714435812856604*^9, {3.714436034487862*^9, 
   3.714436070456593*^9}, 3.714436133785474*^9, {3.714436208058032*^9, 
   3.714436213319762*^9}, 3.714436258284253*^9, {3.714436364709831*^9, 
   3.714436369399967*^9}, {3.714436454494719*^9, 3.714436464663082*^9}, {
   3.714436510641479*^9, 3.714436554189907*^9}, {3.714436665558683*^9, 
   3.714436695236096*^9}, 3.7144367281808987`*^9, 3.7144368751835403`*^9, {
   3.714436962199753*^9, 3.714436997714023*^9}, 3.7144370562186203`*^9, 
   3.714437101501347*^9, 3.714437159625517*^9, 3.71443738449905*^9, 
   3.714437500133555*^9, 3.714437565689076*^9, {3.7144376119650393`*^9, 
   3.714437639417005*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expand in the limit of large pressure", "Subsection",
 CellChangeTimes->{{3.7144371833680363`*^9, 3.714437184168509*^9}, {
  3.714437237216898*^9, 3.714437249171061*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "[", "z", "]"}], "/.", " ", "\[Rho]$g"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "[", "z", "]"}], ",", " ", "\[Infinity]", ",", " ", "0"}],
       "}"}]}], "]"}], " ", "//", "Normal"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.714437250882353*^9, 3.714437333897891*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["2", 
   RowBox[{"1", "/", "4"}]], 
  RowBox[{"kB", " ", "Teff", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", 
      FractionBox["\[Sigma]ir", 
       RowBox[{"g", " ", 
        SuperscriptBox["m", "5"]}]]}], ")"}], 
    RowBox[{"1", "/", "4"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox["1", 
      RowBox[{"p", "[", "z", "]"}]], ")"}], 
    RowBox[{"3", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{{3.7144372978076773`*^9, 3.714437344465349*^9}, 
   3.7144373847831984`*^9, 3.7144375097924547`*^9, 3.7144375695323772`*^9, {
   3.714437612269843*^9, 3.71443763977674*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1026},
WindowMargins->{{1920, Automatic}, {0, Automatic}},
ShowCellTags->True,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 200, 5, 156, "Chapter"],
Cell[CellGroupData[{
Cell[805, 31, 128, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[958, 36, 119, 1, 35, "Subsubsection"],
Cell[1080, 39, 141, 2, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1258, 46, 110, 1, 35, "Subsubsection"],
Cell[1371, 49, 1400, 25, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2808, 79, 136, 1, 35, "Subsubsection"],
Cell[2947, 82, 192, 4, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3176, 91, 129, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[3330, 96, 2041, 44, 48, "Input"],
Cell[5374, 142, 2182, 46, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7617, 195, 161, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[7803, 202, 139, 1, 35, "Subsubsection"],
Cell[7945, 205, 476, 11, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8458, 221, 131, 1, 35, "Subsubsection"],
Cell[8592, 224, 323, 7, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8952, 236, 133, 1, 35, "Subsubsection"],
Cell[9088, 239, 341, 8, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9466, 252, 190, 4, 35, "Subsubsection"],
Cell[9659, 258, 337, 7, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10033, 270, 176, 2, 35, "Subsubsection"],
Cell[10212, 274, 321, 8, 34, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10582, 288, 125, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[10732, 293, 113, 1, 35, "Subsubsection"],
Cell[10848, 296, 269, 7, 44, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11154, 308, 104, 1, 35, "Subsubsection"],
Cell[11261, 311, 408, 11, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11706, 327, 121, 1, 35, "Subsubsection"],
Cell[11830, 330, 344, 9, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12223, 345, 94, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[12342, 350, 214, 4, 45, "Subsection"],
Cell[12559, 356, 704, 18, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13300, 379, 125, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[13450, 384, 445, 7, 35, "Subsubsection"],
Cell[13898, 393, 803, 19, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14738, 417, 270, 5, 35, "Subsubsection"],
Cell[15011, 424, 585, 13, 54, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15633, 442, 381, 7, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[16039, 453, 1117, 25, 34, "Input"],
Cell[17159, 480, 1380, 23, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18612, 511, 143, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[18780, 517, 216, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[19021, 525, 286, 6, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[19332, 535, 549, 12, 32, "Input"],
Cell[19884, 549, 993, 17, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[20904, 570, 190, 4, 35, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21131, 579, 187, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[21343, 587, 233, 5, 35, "Subsubsection"],
Cell[21579, 594, 347, 9, 56, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21963, 608, 116, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[22104, 613, 422, 10, 32, "Input"],
Cell[22529, 625, 973, 17, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23551, 648, 165, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[23741, 655, 542, 14, 34, "Input"],
Cell[24286, 671, 955, 17, 44, "Output"]
}, Open  ]]
}, Open  ]],
Cell[25268, 692, 295, 5, 35, "Subsubsection"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25612, 703, 92, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[25729, 708, 243, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[25997, 716, 171, 3, 35, "Subsubsection"],
Cell[26171, 721, 470, 12, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26678, 738, 492, 8, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[27195, 750, 976, 23, 32, "Input"],
Cell[28174, 775, 1067, 17, 58, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29302, 799, 152, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[29479, 805, 208, 4, 35, "Subsubsection"],
Cell[29690, 811, 299, 7, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30026, 823, 149, 2, 35, "Subsubsection"],
Cell[30178, 827, 235, 5, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30450, 837, 195, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[30670, 843, 326, 8, 32, "Input"],
Cell[30999, 853, 785, 13, 44, "Output"]
}, Open  ]]
}, Open  ]],
Cell[31811, 870, 225, 4, 35, "Subsubsection"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32085, 880, 96, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[32206, 885, 194, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[32425, 893, 138, 1, 35, "Subsubsection"],
Cell[32566, 896, 427, 13, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33030, 914, 176, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[33231, 921, 392, 8, 32, "Input"],
Cell[33626, 931, 928, 20, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34603, 957, 123, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[34751, 962, 279, 7, 32, "Input"],
Cell[35033, 971, 1084, 22, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36178, 1000, 137, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[36340, 1005, 142, 1, 35, "Subsubsection"],
Cell[36485, 1008, 225, 6, 34, "Input"],
Cell[36713, 1016, 394, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37144, 1031, 191, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[37360, 1037, 708, 18, 34, "Input"],
Cell[38071, 1057, 999, 17, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39119, 1080, 173, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[39317, 1087, 590, 17, 34, "Input"],
Cell[39910, 1106, 925, 18, 62, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40884, 1130, 123, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[41032, 1135, 425, 11, 32, "Input"],
Cell[41460, 1148, 885, 15, 45, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42418, 1171, 96, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[42539, 1176, 134, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[42698, 1181, 181, 4, 35, "Subsubsection"],
Cell[42882, 1187, 425, 13, 53, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43344, 1205, 315, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[43684, 1214, 644, 15, 34, "Input"],
Cell[44331, 1231, 940, 19, 61, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45320, 1256, 282, 6, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[45627, 1266, 645, 17, 34, "Input"],
Cell[46275, 1285, 806, 17, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47130, 1308, 379, 10, 40, "Subsubsection"],
Cell[CellGroupData[{
Cell[47534, 1322, 432, 9, 32, "Input"],
Cell[47969, 1333, 1018, 23, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49036, 1362, 470, 8, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[49531, 1374, 524, 11, 32, "Input"],
Cell[50058, 1387, 1082, 26, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51189, 1419, 174, 2, 35, "Subsubsection"],
Cell[51366, 1423, 1036, 29, 48, "Input"],
Cell[CellGroupData[{
Cell[52427, 1456, 194, 3, 55, "Input"],
Cell[52624, 1461, 665, 13, 58, "Output"],
Cell[53292, 1476, 626, 12, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53967, 1494, 131, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[54123, 1499, 279, 7, 32, "Input"],
Cell[54405, 1508, 873, 21, 67, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55339, 1536, 170, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[55534, 1543, 268, 7, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[55827, 1554, 776, 20, 32, "Input"],
Cell[56606, 1576, 741, 18, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57420, 1602, 94, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[57539, 1607, 255, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[57819, 1616, 164, 3, 35, "Subsubsection"],
Cell[57986, 1621, 347, 9, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58370, 1635, 141, 1, 35, "Subsubsection"],
Cell[58514, 1638, 371, 10, 56, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58922, 1653, 158, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[59105, 1659, 1446, 37, 56, "Input"],
Cell[60554, 1698, 956, 21, 68, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61571, 1726, 168, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[61764, 1733, 124, 1, 35, "Subsubsection"],
Cell[61891, 1736, 226, 6, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62154, 1747, 161, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[62340, 1754, 665, 16, 34, "Input"],
Cell[63008, 1772, 2422, 67, 53, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65491, 1846, 121, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[65637, 1851, 243, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[65905, 1860, 238, 5, 32, "Input"],
Cell[66146, 1867, 727, 19, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66946, 1894, 92, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[67063, 1899, 144, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[67232, 1904, 132, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[67389, 1909, 422, 11, 34, "Input"],
Cell[67814, 1922, 532, 12, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68383, 1939, 392, 9, 53, "Input"],
Cell[68778, 1950, 755, 21, 49, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69582, 1977, 214, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[69821, 1985, 1476, 32, 34, "Input"],
Cell[71300, 2019, 1359, 32, 82, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72720, 2058, 176, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[72921, 2064, 432, 12, 34, "Input"],
Cell[73356, 2078, 655, 19, 71, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

